"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5992],{7159:function(t,e,o){o.d(e,{Af:function(){return l},Ej:function(){return i},Oh:function(){return n},Oy:function(){return r},RM:function(){return c},fP:function(){return u},uD:function(){return s}});let a={require:!1,input_error:"Nội dung kh\xf4ng hợp lệ",input_error_state:!1,input_color:"#000000",input_size:16,input_style:"normal"},n={maxLength:100,placeholder:"Nhập nội dung của bạn",minLength:8,...a};({...a});let r=[{type:"province",code:"",name_with_type:"",path_with_type:""},{type:"district",code:"",name_with_type:"",path_with_type:""},{type:"ward",code:"",name_with_type:"",path_with_type:""},{type:"street",code:"",name_with_type:"",path_with_type:""}],i=/[^\s@]+@[^\s@]+\.[^\s@]+/gi,s="Đ\xe2y l\xe0 một c\xe2u trả lời bắt buộc",u=t=>"Độ d\xe0i tối thiếu: ".concat(t),c=t=>"Độ d\xe0i tối đa: ".concat(t),l=t=>t},6348:function(t,e,o){o.d(e,{NO:function(){return i},hI:function(){return a},ss:function(){return r},vm:function(){return n}});let a="^(http|https)://",n="i",r="\xe0\xe1\xe3ảạăằắẳẵặ\xe2ầấẩẫậ\xe8\xe9ẻẽẹ\xeaềếểễệđ\xf9\xfaủũụưừứửữự\xf2\xf3ỏ\xf5ọ\xf4ồốổỗộơờớởỡợ\xec\xedỉĩị\xe4\xeb\xef\xee\xf6\xfc\xfb\xf1\xe7\xfdỳỹỵỷ",i="aaaaaaaaaaaaaaaaaeeeeeeeeeeeduuuuuuuuuuuoooooooooooooooooiiiiiaeiiouuncyyyyy"},2970:function(t,e,o){o.d(e,{Z:function(){return y}});var a=o(3898),n=o(9698),r=o(7907),i=o(5028),s=o(5984),u=o(1231),c=o(8708),l=o(5101);let d=async(t,e,o,a,n,r)=>{let d=new AbortController().signal,f=JSON.parse(await t.text());switch(e){case i.Du:if(["/v1/api/auth/login","/v1/api/auth/register"].includes(a)){let t=(0,u.Z)();throw l.Z.dispatch((0,s.DT)({toast_item:{_id:t,toast_title:"Lỗi x\xe1c thực",core:{message:f.metadata},type:"ERROR"}})),Error(f.metadata)}return await _(n,r,d);case i.Yu:return await p(a);case i.gA:case i.Pb:throw new i.dR({payload:{message:f.message,detail:f.metadata}});default:let m=(0,u.Z)();throw l.Z.dispatch((0,s.DT)({toast_item:{_id:m,toast_title:"Xảy ra lỗi",core:{message:"Thao t\xe1c kh\xf4ng th\xe0nh c\xf4ng, vui l\xf2ng thử lại"},type:"ERROR"}})),l.Z.dispatch((0,c.S)({type:"500"})),new i.oo({status:500})}},f=null,_=async(t,e,o)=>(f||(f=n.Z.refreshTokenClient(o).finally(()=>f=null)),f.then(async o=>{if(+o.code===i.Yu)return await n.Z.logoutNextClient(),(0,r.redirect)("/");let{access_token:a,code_verify_token:s,refresh_token:u}=o.metadata.token,{client_id:c,expireToken:l,expireCookie:d}=o.metadata,f={access_token:a,code_verify_token:s,refresh_token:u,client_id:c,expireToken:JSON.stringify(l),expireCookie:JSON.stringify(d)};await n.Z.syncNextToken(f);let _=await fetch(t,e);return _.ok||(0,r.redirect)("/?code=500"),await _.json()})),p=async t=>("v1/api/auth/logout"===t?((0,a.un)("expireToken"),(0,a.un)("code_verify_token"),window.location.href="/login"):await n.Z.logoutNextClient(),(0,r.redirect)("/")),m=async(t,e,o)=>{let{body:i,baseHeader:s,fullUrl:u}=(0,a.u1)(e,o),c={...o,headers:{...s,...null==o?void 0:o.headers},body:i,method:t,credentials:"include"},l=await fetch(u,c).then(t=>t).catch(t=>{(0,r.redirect)("/errors/internal-server-error")});if(!l.ok)return await d(l,+l.status,t,e,u,c);let f=await l.json();if("v1/api/auth/set-token".includes((0,a.AH)(e))){let{expireToken:t,code_verify_token:e,expireCookie:o}=f;(0,a.uK)("expireToken",t),(0,a.uK)("expireCookie",o),(0,a.uK)("code_verify_token",e)}if(["v1/api/auth/login","v1/api/auth/register"].some(t=>t===(0,a.AH)(e))){let{metadata:t}=f,{client_id:e,expireToken:o,token:{access_token:a,code_verify_token:r,refresh_token:i},expireCookie:s}=t;await n.Z.syncNextToken({access_token:a,code_verify_token:r,refresh_token:i,client_id:e,expireToken:o,expireCookie:s})}return["v1/api/auth/logout"].includes((0,a.AH)(e)),f};class h{static get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m("GET",t,e)}static post(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return m("POST",t,{...o,body:e})}static put(t,e,o){return m("PUT",t,{...o,body:e})}static delete(t){return m("DELETE",t)}}var y=h},5028:function(t,e,o){o.d(e,{Du:function(){return a},Pb:function(){return i},Yu:function(){return n},dR:function(){return c},gA:function(){return r},oo:function(){return s},ox:function(){return u}});let a=401,n=403,r=404,i=400;class s extends Error{constructor({status:t=500,payload:e={message:"INTERNAL SERVER ERROR",detail:""}}){super("Http Error with ".concat(t,": ").concat(e.message," /  ").concat(e.detail)),this.status=t,this.payload=e}}class u extends s{constructor({status:t=n,payload:e}){super({status:t,payload:e}),this.status=n,this.payload=e}}class c extends s{constructor({status:t=r,payload:e={message:"NOTFOUND",detail:""}}){super({status:t,payload:e}),this.status=r,this.payload=e}}},3311:function(t,e,o){o.d(e,{tN:function(){return n}});let a=(0,o(9154).oM)({name:"address",initialState:{provinces:[],districts:[],wards:[]},reducers:{onFetchProvinces:(t,e)=>{t.provinces=e.payload.provinces},onFetchDistricts:(t,e)=>{t.districts=e.payload.districts},onFetchWards:(t,e)=>{t.wards=e.payload.wards}}}),{onFetchProvinces:n,onFetchDistricts:r,onFetchWards:i}=a.actions;e.ZP=a.reducer},6288:function(t,e,o){o.d(e,{LT:function(){return n}});let a=(0,o(9154).oM)({name:"authentication",initialState:{user:null},reducers:{onFetchUser:(t,e)=>{t.user={...e.payload.user}},onLogout:t=>{t.user=null}}}),{onFetchUser:n,onLogout:r}=a.actions;e.ZP=a.reducer},9422:function(t,e,o){o.d(e,{_n:function(){return r},lq:function(){return n}});let a=(0,o(9154).oM)({name:"data-form",initialState:{form_id_current:"",form_cache:{}},reducers:{onCalculationData:(t,e)=>{let{dataExcel:o,dataGroupFilter:a,form_id:n,form_answer_total:r}=e.payload;t.form_cache[n]={dataExcel:o,dataGroupFilter:a,form_id:n,form_answer_total:r},t.form_id_current=n},onChangeFormId:(t,e)=>{t.form_id_current=e.payload.form_id_current}}}),{onCalculationData:n,onChangeFormId:r}=a.actions;e.ZP=a.reducer},7002:function(t,e,o){o.d(e,{DC:function(){return s},P7:function(){return r},Ut:function(){return i},lB:function(){return n}});let a=(0,o(9154).oM)({name:"fornAnswer",initialState:{formAnswerStore:{},form_total_views:-1,form_total_answers:-1},reducers:{addFormAnswer:(t,e)=>{let{form_id:o,reports:a}=e.payload;t.formAnswerStore={...t.formAnswerStore},t.formAnswerStore[o]={...t.formAnswerStore[o],formAnswer:a,update:!1}},clearFormAnswer:(t,e)=>{let{form_id:o}=e.payload;t.formAnswerStore[o]&&(t.formAnswerStore={...t.formAnswerStore},t.formAnswerStore[o]=null)},onFetchTotalViews:(t,e)=>{let{total_views:o}=e.payload;t.form_total_views=o},onFetchTotalAnswer:(t,e)=>{let{total_answers:o}=e.payload;t.form_total_answers=o}}}),{addFormAnswer:n,onFetchTotalAnswer:r,onFetchTotalViews:i,clearFormAnswer:s}=a.actions;e.ZP=a.reducer},5292:function(t,e,o){o.d(e,{PH:function(){return u},Z$:function(){return s},ow:function(){return i},vx:function(){return c}});var a=o(9154);let n={_id:"",form_owner:"",form_views:0,form_button_text:"",form_response:0,form_title:{form_title_mode_image:"Normal",form_title_value:"",form_title_size:40,form_title_color:"#2568aa",form_title_style:"normal",form_title_sub:[]},form_avatar_state:!1,form_background_state:!1,form_mode_display:"basic",form_inputs:[],form_setting_default:{form_avatar_default_url:"",form_background_default_url:"",form_title_size_default:14,form_title_style_default:"normal",form_title_color_default:"#00000",form_avatar_default_mode:"circle",form_avatar_default_postion:"left",input_color:"",input_size:14,input_style:"normal"},form_state:"isDraff"},r=(0,a.oM)({name:"formEdit",initialState:{formCoreOriginal:n,formCoreBackUp:n,colorCore:"",form_delete:0,form_public:0,form_private:0,focus_search:!1},reducers:{onFetchForm:(t,e)=>{t.formCoreOriginal={...e.payload.form},t.formCoreBackUp={...e.payload.form},t.colorCore=e.payload.form.form_title.form_title_color||e.payload.form.form_setting_default.form_title_color_default},onEditForm:(t,e)=>{t.formCoreOriginal=e.payload.form,t.colorCore=e.payload.form.form_title.form_title_color||e.payload.form.form_setting_default.form_title_color_default},onFetchFormState:(t,e)=>{let{form_delete:o,form_private:a,form_public:n}=e.payload;t.form_delete=o,t.form_private=a,t.form_public=n},onFocusSearch:(t,e)=>{let{focus:o}=e.payload;t.focus_search=o}}}),{onFetchForm:i,onEditForm:s,onFetchFormState:u,onFocusSearch:c}=r.actions;e.ZP=r.reducer},8411:function(t,e,o){o.d(e,{GL:function(){return s},aZ:function(){return i},mt:function(){return n}});let a=(0,o(9154).oM)({name:"notification",initialState:{notification:[],animation:!1,new_notification:[]},reducers:{onFetchNotification:(t,e)=>{let{notification:o,animation:a=!1}=e.payload;t.notification=o,t.animation=a},onDisableAnimation:(t,e)=>{let{animation:o=!1}=e.payload;t.animation=o},onAddNewNotification:(t,e)=>{let{notification_item_id:o}=e.payload;t.new_notification=[...t.new_notification,o]},onRemoveNewNotification:(t,e)=>{let{notification_item_id:o}=e.payload;t.new_notification=t.new_notification.filter(t=>t!==o?t:null)}}}),{onFetchNotification:n,onRemoveNewNotification:r,onAddNewNotification:i,onDisableAnimation:s}=a.actions;e.ZP=a.reducer},8708:function(t,e,o){o.d(e,{S:function(){return n}});let a=(0,o(9154).oM)({initialState:{type:null},name:"RenderBaseOnApi",reducers:{fetchStatusCode:(t,e)=>{let{type:o}=e.payload;t.type=o}}}),{fetchStatusCode:n}=a.actions;e.Z=a.reducer},5101:function(t,e,o){var a=o(9154),n=o(6288),r=o(5292),i=o(7002),s=o(8411),u=o(5984),c=o(9422),l=o(3311),d=o(8708);let f=(0,a.xC)({reducer:{authReducer:n.ZP,form:r.ZP,formAsnwer:i.ZP,notification:s.ZP,toast:u.ZP,dataFormHandler:c.ZP,address:l.ZP,renderBaseOnApi:d.Z}});e.Z=f},5984:function(t,e,o){o.d(e,{B1:function(){return f},DT:function(){return c},bY:function(){return u},gs:function(){return d},qx:function(){return s},sV:function(){return l}});var a=o(9154),n=o(2115);let r=(0,a.oM)({name:"toast",initialState:{toast_stack:[],toast_queue:[],toast_timer:10,toast_max_show:4},reducers:{addOneToast:(t,e)=>{let{toast_item:o}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(o):t.toast_stack.push(o)},addOneToastSuccess:(t,e)=>{let{toast_item:o}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(o):t.toast_stack.push(o)},addOneToastWarning:(t,e)=>{let{toast_item:o}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(o):t.toast_stack.push(o)},addOneToastError:(t,e)=>{let{toast_item:o}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(o):t.toast_stack.push(o)},addOneToastFormAnswer:(t,e)=>{let{toast_item:o}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(o):t.toast_stack.push(o)},resetQueueToast:t=>{t.toast_queue=[]},removeOneToast:(t,e)=>{let{toast_item_id:o}=e.payload;if(t.toast_stack=t.toast_stack.filter(t=>t._id===o?null:t),t.toast_queue.length>0){let e=t.toast_queue.shift();t.toast_stack.push((0,n.Vk)(e))}},onUpdateToastGlobal:t=>{if(t.toast_stack.shift(),t.toast_stack.length<t.toast_max_show&&t.toast_queue.length>=1){let e=t.toast_queue.shift();t.toast_stack.push((0,n.Vk)(e))}}}}),{addOneToast:i,addOneToastSuccess:s,addOneToastWarning:u,addOneToastError:c,addOneToastFormAnswer:l,resetQueueToast:d,removeOneToast:f,onUpdateToastGlobal:_}=r.actions;e.ZP=r.reducer},3898:function(t,e,o){o.d(e,{AH:function(){return c},Bs:function(){return h},Fi:function(){return l},Rm:function(){return m},hs:function(){return p},nt:function(){return y},oH:function(){return u},p_:function(){return w},u1:function(){return _},uK:function(){return d},un:function(){return f}}),o(7159),o(2970);var a=o(5101),n=o(9422),r=o(2151),i=o.n(r),s=o(6348);let u=t=>t.match(/[^\s@]+@[^\s@]+\.[^\s@]+/gi),c=t=>t.startsWith("/")?t.slice(1):t,l=(t,e)=>{let o=null==e?void 0:e.split(";"),a={};return o.forEach(t=>{let[e,o]=t.split("=").map(t=>t.trim());a[e]=o}),a[t]},d=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},f=t=>{localStorage.removeItem(t)},_=(t,e)=>{let o;let a=(null==e?void 0:e.body)?e.body instanceof FormData?e.body:JSON.stringify(e.body):void 0,n=(null==e?void 0:e.body)instanceof FormData?{}:{"Content-Type":"application/json"};o=(null==e?void 0:e.baseUrl)===void 0?"http://localhost:4000":"http://localhost:3000";let r=t.startsWith("/")?"".concat(o).concat(t):"".concat(o,"/").concat(t);return{body:a,baseHeader:n,baseUrl:o,fullUrl:r}},p=t=>{let e=s.ss,o=s.NO;for(let a=0,n=e.length;a<n;a++)t=t.replace(RegExp(e[a],"gi"),o[a]);return t=t.toLowerCase().trim().replace(/[^a-z0-9\-]/g,"-").replace(/-+/g,"-")},m=t=>{let e=new RegExp(s.hI,s.vm);return(null==t?void 0:t.match(e))||!1},h=(t,e)=>{let o=[],r={};return t.map(t=>{let e={};t.answers.map(o=>{let a=o.title||"".concat(o.type,"_").concat(o._id),n=o.title||"Kh\xf4ng c\xf3 ti\xeau đề",s=y(o);if(e={...e,"Thời gian gửi":i()(new Date(t.createdAt)).format("hh:mm - Do MMMM YYYY"),[a]:s},r[o._id+"_#_"+o.type])r[o._id+"_#_"+o.type]=r[o._id+"_#_"+o.type].concat({_id:o._id,title:n,value:s,time:t.createdAt,form_answer_id:t._id});else{r[o._id+"_#_"+o.type]=[];let e={_id:o._id,title:n,value:s,time:t.createdAt,form_answer_id:t._id};r[o._id+"_#_"+o.type].push(e)}}),o=o.concat(e)}),a.Z.dispatch((0,n.lq)({dataGroupFilter:r,dataExcel:o,form_id:e,form_answer_total:t.length})),!0},y=t=>{let e="";return"OPTION_MULTIPLE"===t.type?e=t.value.map(t=>t.option_value).join(", "):"OPTION"===t.type?e=t.value.option_value:"DATE"===t.type?"Invalid date"===(e=i()(new Date(t.value)).format(" Do MMMM YYYY"))?"":e:e=t.value},w=t=>"/dashboard"===t?"Trang chủ":"/settings"===t?"C\xe0i đặt":t.startsWith("/profile")?"Trang c\xe1 nh\xe2n":t.endsWith("/edit")?"Trang chỉnh sửa":"/notifications"===t?"Trang th\xf4ng b\xe1o":"/trash"===t?"Trang ":void 0},9698:function(t,e,o){var a=o(2970),n=o(3898),r=o(7907),i=o(5028),s=o(248);class u{static async register(t){return a.Z.post("/v1/api/auth/register",t,{})}static async login(t){return a.Z.post("/v1/api/auth/login",t)}static async logoutNextClient(){let t="v1/api/auth/next-logout",e={baseUrl:""};try{return await a.Z.post("v1/api/auth/logout",{force:!0},{}),await a.Z.post(t,s.Ry,e),window.location.href="/login"}catch(o){return await a.Z.post(t,s.Ry,e),(0,n.un)("expireToken"),(0,n.un)("code_verify_token"),window.location.href="/login?token_expire=true"}return null}static async logoutNextServer(t){let e=(null==t?void 0:t.headers).Cookie,o=(0,n.Fi)("code_verify_token",e),a=(0,n.Fi)("force",e);return(0,r.redirect)("/logout?code_verify_token=".concat(o,"&force=").concat(a))}static async refreshTokenServer(t){let e=await a.Z.get("/v1/api/auth/refresh-token",{credentials:"include",signal:t}),{access_token:o,refresh_token:n,code_verify_token:r}=e.metadata.token,{client_id:i,expireToken:s,expireCookie:u}=e.metadata;return await a.Z.post("/v1/api/auth/set-token",{access_token:o,refresh_token:n,client_id:i,expireToken:s,code_verify_token:r,expireCookie:u},{baseUrl:"",signal:t})}static async refreshTokenClient(t){return console.log("mai"),await a.Z.get("/v1/api/auth/refresh-token",void 0)}static async syncNextToken(t){let{access_token:e,refresh_token:o,code_verify_token:a,client_id:r,expireToken:i,expireCookie:s}=t;await fetch("".concat("http://localhost:3000","/v1/api/auth/set-token"),{body:JSON.stringify({access_token:e,refresh_token:o,client_id:r,code_verify_token:a,expireToken:i,expireCookie:s}),method:"POST"}),(0,n.uK)("expireToken",i),(0,n.uK)("code_verify_token",a),(0,n.uK)("expireCookie",s)}static async tokenExpireRedrict(t){let e=null==t?void 0:t.pathName,o=(null==t?void 0:t.headers).Cookie,a=(0,n.Fi)("code_verify_token",o);return(0,r.redirect)("/v1/api/token/refresh-token?code_verify_token=".concat(a,"&pathName=").concat(e))}static async tokenPermission(t,e){throw new i.ox({status:+t,payload:e})}}e.Z=u}}]);