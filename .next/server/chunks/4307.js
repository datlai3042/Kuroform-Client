"use strict";exports.id=4307,exports.ids=[4307],exports.modules={71622:(t,e,a)=>{a.d(e,{Z:()=>_});var o=a(84141),r=a(63498),s=a(867),i=a(48044);a(33687),a(81636),a(48184);let n=async(t,e)=>{switch(t){case i.Du:return await l(e);case i.Yu:return await c(e);default:(0,s.redirect)("/errors/internal-server-error")}},l=async t=>r.Z.tokenExpireRedrict(t),c=async t=>await r.Z.logoutNextServer(t),u=async(t,e,a)=>{let{body:i,baseHeader:l,fullUrl:c}=(0,o.u1)(e,a),u={...a,headers:{...l,...a?.headers},body:i,method:t,credentials:"include"},d=await fetch(c,u).then(t=>t).catch(t=>{(0,s.redirect)("/errors/internal-server-error")});if(!d.ok)return await n(+d.status,a);let _=await d.json();if("v1/api/auth/set-token".includes((0,o.AH)(e))){let{expireToken:t,code_verify_token:e,expireCookie:a}=_;(0,o.uK)("expireToken",t),(0,o.uK)("expireCookie",a),(0,o.uK)("code_verify_token",e)}if(["v1/api/auth/login","v1/api/auth/register"].some(t=>t===(0,o.AH)(e))){let{metadata:t}=_,{client_id:e,expireToken:a,token:{access_token:o,code_verify_token:s,refresh_token:i},expireCookie:n}=t;await r.Z.syncNextToken({access_token:o,code_verify_token:s,refresh_token:i,client_id:e,expireToken:a,expireCookie:n})}return["v1/api/auth/logout"].includes((0,o.AH)(e)),_};class d{static get(t,e={}){return u("GET",t,e)}static post(t,e,a={}){return u("POST",t,{...a,body:e})}static put(t,e,a){return u("PUT",t,{...a,body:e})}static delete(t){return u("DELETE",t)}}let _=d},48044:(t,e,a)=>{a.d(e,{Du:()=>o,Yu:()=>r,ox:()=>i});let o=401,r=403;class s extends Error{constructor({status:t=500,payload:e={message:"INTERNAL SERVER ERROR",detail:""}}){super(`Http Error with ${t}: ${e.message} /  ${e.detail}`),this.status=t,this.payload=e}}class i extends s{constructor({status:t=r,payload:e}){super({status:t,payload:e}),this.status=r,this.payload=e}}},1389:(t,e,a)=>{a.d(e,{ZP:()=>i});let o=(0,a(15225).oM)({name:"data-form",initialState:{form_id_current:"",form_cache:{}},reducers:{onCalculationData:(t,e)=>{let{dataExcel:a,dataGroupFilter:o,form_id:r,form_answer_total:s}=e.payload;t.form_cache[r]={dataExcel:a,dataGroupFilter:o,form_id:r,form_answer_total:s},t.form_id_current=r},onChangeFormId:(t,e)=>{t.form_id_current=e.payload.form_id_current}}}),{onCalculationData:r,onChangeFormId:s}=o.actions,i=o.reducer},81636:(t,e,a)=>{a.d(e,{Z:()=>s});let o=(0,a(15225).oM)({initialState:{type:null},name:"RenderBaseOnApi",reducers:{fetchStatusCode:(t,e)=>{let{type:a}=e.payload;t.type=a}}}),{fetchStatusCode:r}=o.actions,s=o.reducer},48184:(t,e,a)=>{var o=a(15225);let r=(0,o.oM)({name:"authentication",initialState:{user:null},reducers:{onFetchUser:(t,e)=>{t.user={...e.payload.user}},onLogout:t=>{t.user=null}}}),{onFetchUser:s,onLogout:i}=r.actions,n=r.reducer,l={_id:"",form_owner:"",form_views:0,form_button_text:"",form_response:0,form_title:{form_title_mode_image:"Normal",form_title_value:"",form_title_size:40,form_title_color:"#2568aa",form_title_style:"normal",form_title_sub:[]},form_avatar_state:!1,form_background_state:!1,form_mode_display:"basic",form_inputs:[],form_setting_default:{form_avatar_default_url:"",form_background_default_url:"",form_title_size_default:14,form_title_style_default:"normal",form_title_color_default:"#00000",form_avatar_default_mode:"circle",form_avatar_default_postion:"left",input_color:"",input_size:14,input_style:"normal"},form_state:"isDraff"},c=(0,o.oM)({name:"formEdit",initialState:{formCoreOriginal:l,formCoreBackUp:l,colorCore:"",form_delete:0,form_public:0,form_private:0,focus_search:!1},reducers:{onFetchForm:(t,e)=>{t.formCoreOriginal={...e.payload.form},t.formCoreBackUp={...e.payload.form},t.colorCore=e.payload.form.form_title.form_title_color||e.payload.form.form_setting_default.form_title_color_default},onEditForm:(t,e)=>{t.formCoreOriginal=e.payload.form,t.colorCore=e.payload.form.form_title.form_title_color||e.payload.form.form_setting_default.form_title_color_default},onFetchFormState:(t,e)=>{let{form_delete:a,form_private:o,form_public:r}=e.payload;t.form_delete=a,t.form_private=o,t.form_public=r},onFocusSearch:(t,e)=>{let{focus:a}=e.payload;t.focus_search=a}}}),{onFetchForm:u,onEditForm:d,onFetchFormState:_,onFocusSearch:f}=c.actions,m=c.reducer,p=(0,o.oM)({name:"fornAnswer",initialState:{formAnswerStore:{},form_total_views:-1,form_total_answers:-1},reducers:{addFormAnswer:(t,e)=>{let{form_id:a,reports:o}=e.payload;t.formAnswerStore={...t.formAnswerStore},t.formAnswerStore[a]={...t.formAnswerStore[a],formAnswer:o,update:!1}},clearFormAnswer:(t,e)=>{let{form_id:a}=e.payload;t.formAnswerStore[a]&&(t.formAnswerStore={...t.formAnswerStore},t.formAnswerStore[a]=null)},onFetchTotalViews:(t,e)=>{let{total_views:a}=e.payload;t.form_total_views=a},onFetchTotalAnswer:(t,e)=>{let{total_answers:a}=e.payload;t.form_total_answers=a}}}),{addFormAnswer:h,onFetchTotalAnswer:y,onFetchTotalViews:w,clearFormAnswer:k}=p.actions,v=p.reducer,g=(0,o.oM)({name:"notification",initialState:{notification:[],animation:!1,new_notification:[]},reducers:{onFetchNotification:(t,e)=>{let{notification:a,animation:o=!1}=e.payload;t.notification=a,t.animation=o},onDisableAnimation:(t,e)=>{let{animation:a=!1}=e.payload;t.animation=a},onAddNewNotification:(t,e)=>{let{notification_item_id:a}=e.payload;t.new_notification=[...t.new_notification,a]},onRemoveNewNotification:(t,e)=>{let{notification_item_id:a}=e.payload;t.new_notification=t.new_notification.filter(t=>t!==a?t:null)}}}),{onFetchNotification:S,onRemoveNewNotification:x,onAddNewNotification:A,onDisableAnimation:F}=g.actions,T=g.reducer;var C=a(33687),Z=a(1389);let b=(0,o.oM)({name:"address",initialState:{provinces:[],districts:[],wards:[]},reducers:{onFetchProvinces:(t,e)=>{t.provinces=e.payload.provinces},onFetchDistricts:(t,e)=>{t.districts=e.payload.districts},onFetchWards:(t,e)=>{t.wards=e.payload.wards}}}),{onFetchProvinces:N,onFetchDistricts:O,onFetchWards:E}=b.actions,R=b.reducer;var q=a(81636);(0,o.xC)({reducer:{authReducer:n,form:m,formAsnwer:v,notification:T,toast:C.ZP,dataFormHandler:Z.ZP,address:R,renderBaseOnApi:q.Z}})},33687:(t,e,a)=>{a.d(e,{ZP:()=>m});var o=a(15225),r=a(34128);let s=(0,o.oM)({name:"toast",initialState:{toast_stack:[],toast_queue:[],toast_timer:10,toast_max_show:4},reducers:{addOneToast:(t,e)=>{let{toast_item:a}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(a):t.toast_stack.push(a)},addOneToastSuccess:(t,e)=>{let{toast_item:a}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(a):t.toast_stack.push(a)},addOneToastWarning:(t,e)=>{let{toast_item:a}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(a):t.toast_stack.push(a)},addOneToastError:(t,e)=>{let{toast_item:a}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(a):t.toast_stack.push(a)},addOneToastFormAnswer:(t,e)=>{let{toast_item:a}=e.payload;t.toast_stack.length>=t.toast_max_show?t.toast_queue.push(a):t.toast_stack.push(a)},resetQueueToast:t=>{t.toast_queue=[]},removeOneToast:(t,e)=>{let{toast_item_id:a}=e.payload;if(t.toast_stack=t.toast_stack.filter(t=>t._id===a?null:t),t.toast_queue.length>0){let e=t.toast_queue.shift();t.toast_stack.push((0,r.Vk)(e))}},onUpdateToastGlobal:t=>{if(t.toast_stack.shift(),t.toast_stack.length<t.toast_max_show&&t.toast_queue.length>=1){let e=t.toast_queue.shift();t.toast_stack.push((0,r.Vk)(e))}}}}),{addOneToast:i,addOneToastSuccess:n,addOneToastWarning:l,addOneToastError:c,addOneToastFormAnswer:u,resetQueueToast:d,removeOneToast:_,onUpdateToastGlobal:f}=s.actions,m=s.reducer},84141:(t,e,a)=>{a.d(e,{u1:()=>i,Fi:()=>r,AH:()=>o,uK:()=>s});a(71622),a(48184),a(1389),a(85603);let o=t=>t.startsWith("/")?t.slice(1):t,r=(t,e)=>{let a=e?.split(";"),o={};return a.forEach(t=>{let[e,a]=t.split("=").map(t=>t.trim());o[e]=a}),o[t]},s=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},i=(t,e)=>{let a;let o=e?.body?e.body instanceof FormData?e.body:JSON.stringify(e.body):void 0,r=e?.body instanceof FormData?{}:{"Content-Type":"application/json"};a=e?.baseUrl===void 0?"http://localhost:4000":"http://localhost:3000";let s=t.startsWith("/")?`${a}${t}`:`${a}/${t}`;return{body:o,baseHeader:r,baseUrl:a,fullUrl:s}}},63498:(t,e,a)=>{a.d(e,{Z:()=>c});var o=a(71622),r=a(84141),s=a(867),i=a(48044),n=a(82196);class l{static async register(t){return o.Z.post("/v1/api/auth/register",t,{})}static async login(t){return o.Z.post("/v1/api/auth/login",t)}static async logoutNextClient(){let t="v1/api/auth/next-logout",e={baseUrl:""};try{await o.Z.post("v1/api/auth/logout",{force:!0},{}),await o.Z.post(t,n.Ry,e)}catch(a){await o.Z.post(t,n.Ry,e)}return null}static async logoutNextServer(t){let e=(t?.headers).Cookie,a=(0,r.Fi)("code_verify_token",e),o=(0,r.Fi)("force",e);return(0,s.redirect)(`/logout?code_verify_token=${a}&force=${o}`)}static async refreshTokenServer(t){let e=await o.Z.get("/v1/api/auth/refresh-token",{credentials:"include",signal:t}),{access_token:a,refresh_token:r,code_verify_token:s}=e.metadata.token,{client_id:i,expireToken:n,expireCookie:l}=e.metadata;return await o.Z.post("/v1/api/auth/set-token",{access_token:a,refresh_token:r,client_id:i,expireToken:n,code_verify_token:s,expireCookie:l},{baseUrl:"",signal:t})}static async refreshTokenClient(t){return console.log("mai"),await o.Z.get("/v1/api/auth/refresh-token",void 0)}static async syncNextToken({access_token:t,refresh_token:e,code_verify_token:a,client_id:o,expireToken:s,expireCookie:i}){await fetch("http://localhost:3000/v1/api/auth/set-token",{body:JSON.stringify({access_token:t,refresh_token:e,client_id:o,code_verify_token:a,expireToken:s,expireCookie:i}),method:"POST"}),(0,r.uK)("expireToken",s),(0,r.uK)("code_verify_token",a),(0,r.uK)("expireCookie",i)}static async tokenExpireRedrict(t){let e=t?.pathName,a=(t?.headers).Cookie,o=(0,r.Fi)("code_verify_token",a);return(0,s.redirect)(`/v1/api/token/refresh-token?code_verify_token=${o}&pathName=${e}`)}static async tokenPermission(t,e){throw new i.ox({status:+t,payload:e})}}let c=l}};